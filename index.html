<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CSS Animated Character</title>
    <link rel="stylesheet" href="styles/character.scss">
    <style>
        .character {
            /*background-image:url(jumping.jpg);*/
            background-size:410%;
            background-position:106% -5%;
            background-repeat:no-repeat;
        }
        /*.character * {*/
        /*    opacity:.95;*/
        /*}*/
        /*.character.jump  * {*/
        /*    !*animation-play-state:paused;*!*/
        /*    animation-direction: normal!important;*/
        /*}*/
    </style>
</head>
<body style="background:#242424;">

<div class="characterMount"></div>

<script type="module">
    import AnimatedCharacter from "./scripts/AnimatedCharacter";
    const character = new AnimatedCharacter(document.querySelector('.characterMount'));
    const keysDown = {};

    function goingLeft() {
        return keysDown['a'] || keysDown['ArrowLeft'];
    }

    function goingRight() {
        return keysDown['d'] || keysDown['ArrowRight'];
    }

    function isJumping() {
        return keysDown[' '];
    }

    document.addEventListener('keydown', (event) => {
        keysDown[event.key] = true;
        if (isJumping()) {
            character.jump();
        } else {
            if(goingLeft() || goingRight()) {
                character.walk();
            }

            if(goingRight()) {
                character.backwards = false;
            }

            if(goingLeft()) {
                character.backwards = true;
            }
        }
    });

    document.addEventListener('keyup', (event) => {
        keysDown[event.key] = false;
        event.stopPropagation();
        event.preventDefault();
        if (!goingLeft() && !goingRight()) {
            character.idle();
        }
    });
</script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CSS Animated Character</title>
    <link rel="stylesheet" href="styles/character.scss">
    <style>
        .character {
            /*background-image:url(jumping.jpg);*/
            background-size:410%;
            background-position:106% -5%;
            background-repeat:no-repeat;
        }
        /*.character * {*/
        /*    opacity:.95;*/
        /*}*/
        /*.character.jump  * {*/
        /*    !*animation-play-state:paused;*!*/
        /*    animation-direction: normal!important;*/
        /*}*/
        #characterMount {
            max-width:100%;
        }

        .controls {
            width:100%;
            max-width:320px;
            margin:30px auto;
            text-align:center;
            display:flex;
            flex-direction:row;
        }

        button {
            height:50px;
            width:150px;
            background:#e4e4e4;
            border:none;
            outline:none;
            border-radius:5px;
            margin:0 5px;
            cursor:pointer;
            transition:all .2s ease-in-out;
        }
        button:hover {
            background-color: #b4b4b4;
        }
    </style>
</head>
<body style="background:#242424;">
    <div id="characterMount"></div>
    <div class="controls">
        <button id="walkBackwardButton">
            Walk Left
        </button>
        <button id="jumpButton">
            Jump
        </button>
        <button id="walkForwardButton">
            Walk Right
        </button>
    </div>
    <script type="module">
        import AnimatedCharacter from "./scripts/AnimatedCharacter";
        import KeyboardControls from "./scripts/KeyboardControls";
        const character = new AnimatedCharacter(document.getElementById('characterMount'));
        const keyboardControls = new KeyboardControls(character);
        keyboardControls.start();

        ['mousedown', 'touchstart'].forEach((eventName) => {
            document.addEventListener(eventName, (event) => {
                const element = event.target;
                keyboardControls.clearInputInterval();

                if(element.matches('#walkForwardButton')) {
                    character.walk(false);
                }

                if(element.matches('#jumpButton')) {
                    character.jump();
                }

                if(element.matches('#walkBackwardButton')) {
                    character.walk(true);
                }
            });
        });

        ['mouseup', 'touchend'].forEach((eventName) => {
            document.addEventListener(eventName, () => {
                keyboardControls.setInputInterval();
            });
        });
    </script>
</body>
</html>
